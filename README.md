# BootStrapping
Python script to perform bootstrapping from a CrystFEL stream file

## Usage
```
usage: bootstrapp_stream.py [-h] [--stream STREAM] [-n N] [--output OUTPUT] [--json JSON]

Given a CrystFEL stream, n bootstrapped streams will be generated. If this script has already been used, the generated json can be passed as an argument to avoid parsing the CrystFEL
stream file another time

options:
  -h, --help            show this help message and exit
  --stream STREAM, -s STREAM
                        Input crystFEL stream file
  -n N                  Number of bootstrapped streamfiles to create (defaut=1)
  --output OUTPUT, -o OUTPUT
                        Basename for bootstrapped streams. Trailing numbers will be added
  --json JSON, -j JSON  Optional json file (generated by this script at first use)
```

An example stream is provided (example_1k_indexed.stream), which contains 1000 indexed images.
With the bootstrapping sampling approach, a resampled dataset is generated by drawing with replacement.
The resampled dataset contains the same number of indexed patterns (i.e 1000), with the possibility to have the same indexed pattern being present multiple times.

If this is first time you want to generate boostrapped streams for this stream, run the scripts as follows:
```
python --stream example_1k_indexed.stream
```

This will generate a json file (example_1k_indexed.json) which can further be used if the script is called again. 
This avoids parsing the original crystfel stream again and again each time the script is used for this specific input stream. 
It is particulalrly useful for crystFEL stream files of tens of thoushands indexed patterns.

By default, a single bootstrapped stream (example_1k_indexed_000.stream) will be generated. 
You can generated more (recommended for statistical purposes) with -n paramters.
```
python --stream example_1k_indexed.stream --json example_1k_indexed.json -n 10
```
This command will generate 10 boostrapped streams, using the previously created json file (to avoid parsing the input stream again).
Beware, example_1k_indexed_000.stream will be overwritten. 



